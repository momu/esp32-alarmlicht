# turn on the alarmlicht_led, switch REL1 on for 300ms and â€“ depending
# on the global boolean variables - do Divera and ntfy HTTP request
# to trigger alerts via their API
- logger.log: 
    format: "Pager received a message"
    level: INFO
- output.turn_on: alarmlicht_led
# switch the relay off after some time
- output.turn_on: relay_1
- delay: ${relay_on_time}
- output.turn_off: relay_1
- if: 
    condition: 
      lambda: 'return id(global_send_divera_alarm);'
    then: !include
      file: http-request-divera.yaml
      vars:
        log_text: "Sending Divera alert."
        divera_type: ${divera_type}
- if: 
    condition: 
      lambda: 'return id(global_send_ntfy_alarm);'
    then: !include
      file: http-request-ntfy.yaml
      vars:
        log_text: "Sending ntfy alert."
        ntfy_title: ${ntfy_title}
        ntfy_priority: ${ntfy_priority}
        ntfy_tags: ${ntfy_tags}
        ntfy_body: ${ntfy_body}